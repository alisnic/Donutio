/* Donutio 2.4.3 by Michael Hohlovich */
!function(t){var e=function(e){return this.each(function(){var n=t.extend({multiple:!0,color_negative:"#f00",color_positive:"#0f0",radius:200,width:10,padding:10,type:"donut",active:0,percents:!1,colored_percents:!1},e),r=2*(n.radius+n.padding),c=n.data.length,l=o(n.data),f=s(u(n.data,l),c),d=f[0],h=f[1];if(n.multiple)for(i=0;c>i;i++)a(r,d,n,h,i,t(this),l);else a(r,d,n,h,n.active,t(this),l)})},n=function(){return this.each(function(){var e=t(this).find(".donut");e.each(function(e,n){t(n).off()}),t(this).empty()})},r={init:e,destroy:n};t.fn.donutio=function(e){return r[e]?r[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.Donutio"):r.init.apply(this,arguments)};var a=function(e,n,r,i,a,o,u){var s=c(e),d=l("svg");d.setAttribute("width",e),d.setAttribute("height",e);var p=0,v=0;for(j=0;j<r.data.length;j++){p=v+n,v=p+i[j];var g=h(r,a);if(0==p&&360==v){var b=l("circle");b.setAttribute("cx",e/2),b.setAttribute("cy",e/2),b.setAttribute("r",r.radius)}else{var b=l("path");b.setAttribute("d",f(r.type,Math.floor(e/2),Math.floor(e/2),r.radius,p,v))}"donut"==r.type?(b.setAttribute("stroke-width",r.width),b.setAttribute("fill","none"),j==a?b.setAttribute("stroke",g.active):b.setAttribute("stroke",g.muted)):(b.setAttribute("stroke-width",0),j==a?b.setAttribute("fill",g.active):b.setAttribute("fill",g.muted)),d.appendChild(b)}if(s.append(d),r.percents){var y=(Math.round(Math.abs(r.data[a].value)/u*1e4)/100).toString()+"%",w=t("<span class='value-percent' />").html(y);r.colored_percents&&w.css("color",g.active),s.append(w)}if("text"in r.data[a]&&r.data[a].text.forEach(function(e,n){w=t("<span class='value-"+n+"' />").html(e),s.append(w)}),"url"in r.data[a]){var m=r.data[a].url,A=t("<a href='"+m+"' />").html(s);o.append(A)}else if(o.append(s),t.isFunction(r.onclick)){var x=r.onclick;s.on("click",function(t){t.preventDefault(),x(r.data[a].id)})}},o=function(t){var e=0;return t.forEach(function(t){e+=Math.abs(t.value)}),e},u=function(t,e){var n=[];return t.forEach(function(t){var r=Math.abs(t.value)/e*100,i=Math.floor(r);r>.005&&1>=r&&(i=1);var a=Math.ceil(3.6*i);n.push(a)}),n},s=function(t,e){var n=360-t.reduce(function(t,e){return t+e}),r=n/e;if(1>r||r>1.5){var i=r-1.5;t=t.map(function(t){return t+i}),r=1.5}return 1==t.length&&(t=[360],r=0),[r,t]},c=function(e){return t("<div class='donut' />").css({width:e})},l=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg",t);return"svg"==t&&e.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),e},f=function(t,e,n,r,i,a){var o=d(e,n,r,a),u=d(e,n,r,i),s=180>=a-i?"0":"1",c=[];return c="donut"==t?["M",o.x,o.y,"A",r,r,0,s,0,u.x,u.y].join(" "):["M",o.x,o.y,"A",r,r,0,s,0,u.x,u.y,"L",e,n,"L",o.x,o.y].join(" ")},d=function(t,e,n,r){var i=(r-90)*Math.PI/180;return{x:t+n*Math.cos(i),y:e+n*Math.sin(i)}},h=function(t,e){var n=t.data[e].value;return n>0?{active:t.color_positive,muted:p(.8,t.color_positive,"#fff")}:{active:t.color_negative,muted:p(.8,t.color_negative,"#fff")}},p=function(t,e,n){if("number"!=typeof t||-1>t||t>1||"string"!=typeof e||"r"!=e[0]&&"#"!=e[0]||"string"!=typeof n&&"undefined"!=typeof n)return null;this.sbcRip||(this.sbcRip=function(t){var e=t.length,n=new Object;if(e>9){if(t=t.split(","),t.length<3||t.length>4)return null;n[0]=r(t[0].slice(4)),n[1]=r(t[1]),n[2]=r(t[2]),n[3]=t[3]?parseFloat(t[3]):-1}else{switch(e){case 8:case 6:case 3:case 2:case 1:return null}6>e&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(e>4?t[4]+""+t[4]:"")),t=r(t.slice(1),16),n[0]=t>>16&255,n[1]=t>>8&255,n[2]=255&t,n[3]=9==e||5==e?i((t>>24&255)/255*1e4)/1e4:-1}return n});var r=parseInt,i=Math.round,a=e.length>9,a="string"==typeof n?n.length>9?!0:"c"==n?!a:!1:a,o=0>t,t=o?-1*t:t,n=n&&"c"!=n?n:o?"#000000":"#FFFFFF",u=sbcRip(e),s=sbcRip(n);return u&&s?a?"rgb("+i((s[0]-u[0])*t+u[0])+","+i((s[1]-u[1])*t+u[1])+","+i((s[2]-u[2])*t+u[2])+(u[3]<0&&s[3]<0?")":","+(u[3]>-1&&s[3]>-1?i(1e4*((s[3]-u[3])*t+u[3]))/1e4:s[3]<0?u[3]:s[3])+")"):"#"+(4294967296+16777216*(u[3]>-1&&s[3]>-1?i(255*((s[3]-u[3])*t+u[3])):s[3]>-1?i(255*s[3]):u[3]>-1?i(255*u[3]):255)+65536*i((s[0]-u[0])*t+u[0])+256*i((s[1]-u[1])*t+u[1])+i((s[2]-u[2])*t+u[2])).toString(16).slice(u[3]>-1||s[3]>-1?1:3):null}}(jQuery);
